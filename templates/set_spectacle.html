<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="../../favicon.ico">

  <title>MODIFIER SPECTACLE</title>

  <!-- Bootstrap core CSS -->
  <link href="../static/boot4/css/bootstrap.css" rel="stylesheet">


  <!-- Custom styles for this template -->
  <link href="../static/styles/navbar.css" rel="stylesheet">
  <link href="../static/styles/charte.css" rel="stylesheet">

  <script>
  var contactAffiche = 0
  function addNewContact() {
    var div = document.createElement("div");
    var inputName = document.createElement("INPUT");
    inputName.setAttribute("type", "text");
    inputName.setAttribute("id", "nomUser");
    inputName.setAttribute("class", "form-control");
    inputName.setAttribute("name", "nomUser");
    inputName.setAttribute("placeholder","Nom");

    div.appendChild(inputName);

    var inputPrenom = document.createElement("input");
    inputPrenom.setAttribute("type", "text");
    inputPrenom.setAttribute("id", "prenomUser");
    inputPrenom.setAttribute("class", "form-control");
    inputPrenom.setAttribute("name", "prenomUser");
    inputPrenom.setAttribute("placeholder","Prenom");

    div.appendChild(inputPrenom);

    var telephone = document.createElement("input");
    telephone.setAttribute("type", "integer");
    telephone.setAttribute("id", "telephone");
    telephone.setAttribute("name", "telephone");
    telephone.setAttribute("placeholder","Numero de Telephone");

    div.appendChild(telephone);

    var adressemail = document.createElement("input");
    adressemail.setAttribute("type", "text");
    adressemail.setAttribute("id", "adressemail");
    adressemail.setAttribute("class", "form-control");
    adressemail.setAttribute("name", "adressemail");
    adressemail.setAttribute("placeholder","Adresse email");

    div.appendChild(adressemail);

    var annee = document.createElement("select");
    annee.id = "anneeSelect";
    annee.name="anneeSelect";

    for (var x = 0; x < 6; x++) {
        var option = document.createElement("option");
        option.value = x;
        option.text = x;
        annee.appendChild(option);
    }
    div.appendChild(annee);


    var depart = document.createElement("select");
    depart.id = "departSelect";
    depart.name="departSelect";

    departement = ["exterieur","Bioscience","GCU","GE","GEN","GI","GM","IF","PC","SGM","TC"];
    for (var x = 0; x < departement.length; x++) {
        var option = document.createElement("option");
        option.value = departement[x];
        option.text = departement[x];
        depart.appendChild(option);
    }
    div.appendChild(depart);

    var bouton = document.createElement("button");
    bouton.setAttribute("name", "button");
    bouton.setAttribute("id", "boutonContact");
    bouton.setAttribute("value", "boutonAddContact");
    bouton.setAttribute("type","boutonContact");
    var t = document.createTextNode("Valider Contact");

    bouton.appendChild(t);

    div.appendChild(bouton);

    if (contactAffiche == 0) {
      contactAffiche=1
      document.getElementById("contact").appendChild(div);
      document.getElementById("addContactbutton").innerHTML = "Annuler Contact";
    } else if (i == 1) {
      contactAffiche=0
      document.getElementById("addContactbutton").innerHTML = "Ajouter Contact";
      document.getElementById("contact").innerHTML = "";
    }
  }

  var i = 0;
  var datesLength = {{nDates}};
  init(datesLength);

  function init(val) {
    i = val;
  }
  function addOneDate() {
    var lastDate = document.getElementById("datetime" + i.toString());
    var lastNPlaces = document.getElementById("nPlaces" + i.toString());

    var div = document.createElement("div");
    var inputDate = document.createElement("INPUT");
    inputDate.setAttribute("type", "datetime-local");
    i++;
    inputDate.setAttribute("name", "datetime" + i.toString());
    inputDate.setAttribute("id", "datetime" + i.toString());
    console.log(i);

    var br = document.createElement("br");

    div.appendChild(inputDate);

    var nPlace = document.createElement("input");
    nPlace.setAttribute("type", "number");
    nPlace.setAttribute("id", "nPlaces" + i.toString());
    nPlace.setAttribute("name", "nPlaces" + i.toString());
    nPlace.setAttribute("min", "0");
    nPlace.setAttribute("max", "500");

    if (lastDate) {
      inputDate.setAttribute("value", lastDate.value);
    }
    if (lastNPlaces) {
      nPlace.setAttribute("value", lastNPlaces.value);
    }

    div.appendChild(nPlace);

    document.getElementById("date-div").appendChild(br);
    document.getElementById("date-div").appendChild(div);
  }
  </script>

</head>

<body>

  <header>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-expand bg-light navbar-light fixed-top ">
      <a class="navbar-brand" href="#"><img src="../static/styles/logo_insa.png" style="height: 40px;" alt="logo"></a>

      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Accueil</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/calendrier">Calendrier</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/panier">Panier</a>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li class="nav-item active">
            <a class="nav-link" href="/admin">Admin</a>
          </li>
        </ul>

      </div>
    </nav>
  </header>

  <div class="container-fluid">
    <p>Bienvenue sur la page de modification/création de spectacle : </p>
    <p>{{spectacle.nom}}
      <form action="" method="POST" enctype="multipart/form-data">
        <div class="form-group">
          <label for="nom du spectacle">Nom du spectacle:<abbr title="required"></abbr></label><br>
          <input type="text" id="nom" class="form-control" name="nom" value='{{spectacle.nom}}'><br>
        </div>
        <div class="form-group">
          <label for="resume">Résumé:</label><br>
          <textarea type="text" id="resume" row="4" class="form-control" name="resume" value='{{spectacle.resume}}' size=50></textarea>
        </div>
        <div class="form-group">
          <label for="photos">Photos:</label><br>
          <input type="file" class="form-control-file" name="photos" accept=".png, .jpg, .jpeg" multiple><br>
        </div>
        <div class="form-group">
          <label for="liens">Liens:</label><br>
          <input type="url" name="liens" class="form-control" value='{{spectacle.liens}}'><br>
        </div>
        <div class="form-group">
          <label for="directeur">Par:</label><br>
          <input type="text" name="directeur" class="form-control" value='{{spectacle.directeur}}'><br>
        </div>
        <div class="form-group">
          <label for="auteur">Auteur:</label><br>
          <input type="text" name="auteur" class="form-control" value='{{spectacle.auteur}}'><br>
        </div>
        <div class="form-group">
          <label for="participants">Avec:</label><br>
          <input type="text" name="participants" class="form-control" value='{{spectacle.participants}}'><br>
        </div>
        <div class="form-group">
          <label for="typeSpectacle">Genre:</label><br>
          <select type="text" name="typeSpectacle" class="form-control" value='{{spectacle.typeSpectacle}}' multiple>
              <option value="Théâtre">Théâtre</option>
              <option value="Musique">Musique</option>
              <option value="Danse">Danse</option>
              <option value="Impro">Impro</option>
              <option value="Conférence">Conférence</option>
              <option value="Cirque">Cirque</option>
              <option value="Performance">Performance</option>
              <option value="Autre">Autre</option>
          </select>
        </div>
        <div class="form-group">
          <label for="duree">Durée (en minutes):</label><br>
          <input type="number" name="duree" class="form-control" value='{{spectacle.duree}}'><br>
        </div>
        <div class="form-group">
          <label for="tarf">Tarif:</label><br>
          <input type="number" name="tarf" class="form-control" value='{{spectacle.tarif}}'><br>
        </div>
        <div>
          <p>Contacts : </p>
          <select name=ajoutContactDB>
            {%for c in contact:%}
            <option value="{{c.id}}">{{c.nom}} {{c.prenom}} {{c.annee}}{{c.depart}}</option>
            {%endfor%}
          </select>
          <button type="button" id="addContactbutton" onclick="addNewContact();" name="addContactbutton">Ajouter Contact</button>
          <br>
          <br>
          <div id="contact">
          </div>
        </div>
        <br>
        <div>
          <label for="dates">Dates :  </label>
          <button type="button" id="addDate" onclick="addOneDate()" name="addDate" valur="addDate">Add</button><br>
          <script>

          </script>
          <div id="date-div">
            {%for date in dates:%}
            <div id="date{{loop.index}}">
              <input type="datetime-local" value="{{date.date}}" id="datetime{{loop.index}}" name="datetime{{loop.index}}">
              <input type="number" value="{{date.placesRestantes}}" id="nPlaces{{loop.index}}" name="nPlaces{{loop.index}}" min="0" max="500">
            </div>
            {%endfor%}
          </div>
        </div>

        <div>
          <br><br>
          <button name="button" id="valide" value="valider" type="valide" }>Valider</button>

        </div>
      </form>
    </div>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
    window.jQuery || document.write('<script src="../static/assets/js/vendor/jquery.min.js"><\/script>')
    </script>
    <script src="../static/boot4/js/bootstrap.min.js"></script>
  </body>

  </html>
