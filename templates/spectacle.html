{% extends "layout.html" %}
{% set active_page = 'spectacle' %}
{%block head%}
{{super()}}
  <script src="/static/color-thief.js"></script>
  <script>


    var paths = new Array({{paths|length}});
    var i =0;
    {%for path in paths%}
    paths[i] ="{{path}}" ;
    console.log(paths[i]);
    i++;
    {%endfor%}
    i=0;

    var colorThief = new ColorThief();

    function chgPhoto(){
      var image = document.getElementById("imgSpectacle");
      image.onload = function(){
        var c = colorThief.getColor(image);
        var p = colorThief.getPalette(image);
        console.log(p);
        image.style.backgroundColor = 'rgb(' + [c[0],c[1],c[2]].join(',') + ')';
        document.getElementsByClassName('color-box1')[0].style.backgroundColor = 'rgb(' + [c[0],c[1],c[2]].join(',') + ')';
        for(j=0; j<9; j++){
          var cobox = "color-box"+(j+2)
          console.log(cobox);
          document.getElementsByClassName(cobox)[0].style.backgroundColor = 'rgb(' + [p[j][0],p[j][1],p[j][2]].join(',') + ')';
        }

      }
      i++;
      if(i>=paths.length)i=0;
      image.setAttribute("src",paths[i]);


      console.log(paths[i]);
    }

    var month=new Array(12);
  month[0]="janvier";  month[1]="février";   month[2]="mars";
  month[3]="avril";    month[4]="mai";       month[5]="juin";
  month[6]="juillet";  month[7]="août";      month[8]="septembre";
  month[9]="octobre";  month[10]="novembre"; month[11]="décembre";





  </script>
{%endblock%}
{% block title %}{{spectacle.nom.upper()}}{% endblock %}


{% block content %}


  <div class="container">
      <div class="row">
        <div class="col-md-8 ">
          <div class="card card-eq-height">
          <div class="card-body">
            <h2 class="card-title">{{spectacle.nom.upper()}} </h2>
            {%if spectacle.auteur%}
            <h4 class="card-title">{{spectacle.auteur.upper()}} </h4>
            {%endif%}
            {%if spectacle.resume %}
            <p class="card-resume">{{spectacle.resume}}</p>
            {%endif%}
          </div>
        </div>
        </div>
        <div class="col-md-4 ">
          <div class="card card-eq-height">
          <div class="card-body">
            <h5 class="card-title">{{spectacle.directeur.upper()}} </h5>
            <p class="card-participants">Avec {{spectacle.participants}}</p>

          </div>
        </div>

      </div>
    </div>

      <div class="row">
        <div class="col-md-4 ">
          <div class="card card-eq-height">
            <div class="card-body card-body-tarifs-dates">
              <h5 class="card-title card-title-tarifs-dates">Du JJ au JJ MM </h5>
              <p>Tarifs\nVA :\nEEE euros\nNON VA :\nEEE euros</p>
            </div>
            <div class="card-footer card-footer-billet" onclick="afficheBillets()">
            <p>BILLETS | DATES</p>
            </div>
          </div>
        </div>

        <script>
        function mouseEnter(){
          var e=document.getElementsByClassName("content")[0].style.opacity=1;
          console.log("HOVER : ",e);
        }
        function mouseLeave(){
          var e=document.getElementsByClassName("content")[0].style.opacity=0;
          console.log("HOVER : ",e);
        }


        </script>
        <div id="showImage"  class="col-md-8 ">
          <div class="imageSpectacle" onmouseleave="mouseLeave()" onmouseenter="mouseEnter()">
            <img onclick="chgPhoto()" id="imgSpectacle" class="card-imgSpectacle" src="{{paths[0]}}">
          </div>
        </div>
        <div class="content" onmouseleave="mouseLeave()">
          <div class="row ">
              <div class="color-box1"></div>
              <div class="color-box2"></div>
              <div class="color-box3"></div>
              <div class="color-box4"></div>
              <div class="color-box5"></div>
              <div class="color-box6"></div>
              <div class="color-box7"></div>
              <div class="color-box8"></div>
              <div class="color-box9"></div>
              <div class="color-box10"></div>
          </div>
        </div>
      </div>


    </div>
  </div>

  <!-- <div class="row">
    <div class="col-md-1">
      <div class="color-box">a</div>
    </div>
    <div class="col-md-1">
      <div class="color-box">a  </div>
    </div>
  </div> -->


  <form action="" method="POST">
    <p> Quelles dates souhaitez vous réserver ?</p>
    <p> Date Places Restantes </p>
    <ul>
      {%for date in dates %}
      <li>{{date.date}} {{date.placesRestantes}}
        <input type="number" id="places" name="{{date.date}}" min="0" max="{{date.placesRestantes}}"> </li>

      {% endfor %}
    </ul>
      <ul>
        <button name="submit" value="valider" type="submit">Valider</button>
         {%if session.admin == 'super' or session.pseudo == spectacle.admin%}
        <button name="submit" value="modify" type="submit">Modifier</button>
        {%endif%}
        <br></br>
      </ul>
  </form>
{% endblock %}
